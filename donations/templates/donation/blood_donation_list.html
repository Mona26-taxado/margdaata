{% extends base_template %}
{% block content %}
<style>
    .container.mt-7 {
        margin-top: 3rem;
       
}

/* Fix Table Responsiveness */
.table-responsive {
    overflow-x: auto;
    display: block;
}

/* Keep Table Structure on Mobile */
@media (max-width: 768px) {
    .table-responsive {
        overflow-x: auto;
        display: block;
    }

    /* Allow Table to Scroll Horizontally Instead of Stacking */
    table {
        width: 100%;
        display: block;
        overflow-x: auto;
        white-space: nowrap; /* Prevent text from wrapping */
    }

    /* Keep Headers Visible */
    thead {
        display: table-header-group; /* Ensures headers are visible */
    }

    /* Ensure Row Content Stays in a Single Line */
    tr, td, th {
        display: table-cell;
        text-align: center;
        vertical-align: middle;
    }

    /* Reduce Font Size for Small Screens */
    td, th {
        font-size: 14px;
        padding: 5px;
    }
}
</style>


<div class="container mt-7">
    <h2 class="text-center text-primary">
        <i class="fa fa-heartbeat text-danger"></i> Blood Donation Requests
    </h2>
    <hr>

    <!-- Make Table Responsive -->
    <div class="table-responsive">
        <table class="table table-bordered table-hover">
            <thead class="table-dark">
                <tr>
                    <th>S.No</th>
                    <th>Name</th>
                    <th>Blood Group</th>
                    <th>Contact</th>
                    <th>Category</th>
                    <th>Status</th>
                    <th>Self Declaration</th>
                    {% if request.user.is_staff %}
                    <th>Actions</th>
                    {% endif %}
                </tr>
            </thead>
            <tbody>
                {% for donation in donations %}
                <tr>
                    <td data-label="S.No">{{ forloop.counter }}</td>
                    <td data-label="Name">{{ donation.name }}</td>
                    <td data-label="Blood Group">{{ donation.blood_group }}</td>
                    <td data-label="Contact">{{ donation.contact }}</td>
                    <td data-label="Category">{{ donation.category }}</td>
                    <td data-label="Status">
                        {% if donation.status == "Pending" %}
                            <span class="badge bg-warning">{{ donation.status }}</span>
                        {% elif donation.status == "Approved" %}
                            <span class="badge bg-success">{{ donation.status }}</span>
                        {% else %}
                            <span class="badge bg-primary">{{ donation.status }}</span>
                        {% endif %}
                    </td>
                    <td data-label="Self Declaration">
                        {% if donation.self_declaration %}
                        <a href="{{ donation.self_declaration.url }}" class="btn btn-warning btn-sm" target="_blank">View</a>
                        {% else %}
                        No File
                        {% endif %}
                    </td>
                    {% if request.user.is_staff %}
                    <td data-label="Actions">
                        <a href="{% url 'update_blood_donation_status' donation.id 'Approved' %}" class="btn btn-success btn-sm">
                            <i class="fa fa-check"></i> Approve
                        </a>
                        <a href="{% url 'update_blood_donation_status' donation.id 'Completed' %}" class="btn btn-primary btn-sm">
                            <i class="fa fa-check-circle"></i> Complete
                        </a>
                        <a href="{% url 'update_blood_donation_status' donation.id 'Pending' %}" class="btn btn-secondary btn-sm">
                            <i class="fa fa-clock"></i> Pending
                        </a>
                    </td>
                    {% endif %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

{% endblock %}
